<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Map | Energy Consumption & Trends</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" type="text/css" href="https://www.mapbox.com/base/latest/base.css">
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>    
    <style>
        .sidebar { width:300px; }
        .legend { background-color:#f1f1f0; }
        .lifted { box-shadow:0 1px 2px rgba(0,0,0,0.10); }

        /* Mobile */
        @media only screen and (max-width:640px) {
        .sidebar {
            position:absolute;
            width:100%;
            padding:0;
            margin:0;
            top:auto;
            bottom:0;
            height:25%;
            z-index:10;
        }
        .sidebar-inner {
            height:100%;
            border-radius:0;
        }
        .sidebar-inner > * { border-radius:0; }
        .legend {
            position:absolute;
            bottom:0;
        }
    }
    </style>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
</head>
<body>

<div class="sidebar pin-topleft z1 pad1">
  <div class="sidebar-inner fill-white round lifted">
    <header class="pad2">
      <h3>Energy Use By Building (kWh)</h3>
    </header>
    <div id="info">
        <center>
            <input style="width:200px" type="text" name="daterange" value="01/01/2017 - 01/02/2017" />
            <p class="pad1">
                See by shades of red the ranges of energy different buildings at the university use.
            </p>
        </center>
    </div>
    <br />
    <div id="legend" class="legend quiet col12 clearfix round-bottom mobile-cols">
      <div class="strong micro pad1x pad0y col2 center round-bottomleft" style="background-color: rgba(255, 255, 255, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 204, 204, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 153, 153, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 102, 102, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 51, 51, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center round-bottomright" style="background-color: rgba(255, 0, 0, 0.5)"></div>
    </div>
  </div>
</div>

<div class="sidebar pin-right z1 pad1">
  <div class="sidebar-inner fill-white round lifted">
    <header class="pad2">
      <h3>High Energy Buildings</h3>
    </header>
    <div id="info">
        <center>
            The top ten buildings in regards to energy usage.
            <div class="pad1">

                <ol id="building-list" class='txt-ol'>
                </ol>  
            </div>
        </center>
    </div>

    <br />
    <div id="legend" class="legend quiet col12 clearfix round-bottom mobile-cols">
      <div class="strong micro pad1x pad0y col2 center round-bottomleft" style="background-color: rgba(255, 255, 255, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 204, 204, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 153, 153, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 102, 102, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center" style="background-color:rgba(255, 51, 51, 0.5)"></div>
      <div class="strong micro pad1x pad0y col2 center round-bottomright" style="background-color: rgba(255, 0, 0, 0.5)"></div>
    </div>
  </div>
</div>


<div id='map'></div>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoidmlsdGFyaWEiLCJhIjoiY2l3MzZxa3g2MDJ2ZTJvbGVzaDhxYzN4MiJ9.qdvAux8_dDTMQPTdTjPVYw';
var buildings = {
    "agriculture_engineering": {"geometry":{"type":"Polygon","coordinates":[[[-157.815899848938,21.30180470813501],[-157.81589180231094,21.301526073839824],[-157.8163719177246,21.301514828498426],[-157.81637996435165,21.301793462814942],[-157.815899848938,21.30180470813501]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "architecture": {"geometry":{"type":"Polygon","coordinates":[[[-157.82055214047432,21.3001129025307],[-157.8205481171608,21.300031685375828],[-157.8205105662346,21.300032934870856],[-157.820495814085,21.29967557885925],[-157.82052531838417,21.29966558287441],[-157.82052129507065,21.29957062098447],[-157.82086730003357,21.29957062098447],[-157.82086730003357,21.29958811396881],[-157.8209249675274,21.299585614971164],[-157.8209263086319,21.299648089899293],[-157.8209611773491,21.299646840400996],[-157.82097592949867,21.30002418840543],[-157.82094106078148,21.300025437900516],[-157.8209437429905,21.30009915809225],[-157.82055214047432,21.3001129025307]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "bachman_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81977429986,21.297542670187795],[-157.8197756409645,21.296954146880623],[-157.81990438699722,21.296954146880623],[-157.81990438699722,21.297129079744593],[-157.82017394900322,21.297129079744593],[-157.82017394900322,21.297372735886725],[-157.82023295760155,21.297373985404363],[-157.82023295760155,21.297480194364653],[-157.8199714422226,21.297480194364653],[-157.8199714422226,21.297542670187795],[-157.81977429986,21.297542670187795]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "biomedical_science": {"geometry":{"type":"Polygon","coordinates":[[[-157.81413093209267,21.303961294719315],[-157.81410813331604,21.303060430128895],[-157.8145158290863,21.30305168384365],[-157.8145144879818,21.303022946045644],[-157.81447291374207,21.303029193393513],[-157.81436428427696,21.30302044710642],[-157.81432539224625,21.30301045134911],[-157.81429588794708,21.302999206121314],[-157.81437635421753,21.302830527601174],[-157.81441658735275,21.30284427178414],[-157.81445279717445,21.302846770726347],[-157.8144809603691,21.302851768610665],[-157.81454399228096,21.302855517023787],[-157.8145855665207,21.30285426755276],[-157.8146432340145,21.30284427178414],[-157.81468749046326,21.3028317770724],[-157.81471699476242,21.302823030773567],[-157.81475454568863,21.30280553817431],[-157.81479477882385,21.30288925273757],[-157.8148417174816,21.302886753796074],[-157.81486988067627,21.302957973612052],[-157.81476393342018,21.303001705060908],[-157.8147652745247,21.303046685966137],[-157.81509652733803,21.303039189149544],[-157.81511932611465,21.30394005387022],[-157.81413093209267,21.303961294719315]],[[-157.81452789902687,21.30329533016608],[-157.81495571136475,21.30328658389483],[-157.81495302915573,21.30316538551105],[-157.81452521681786,21.30317413178952],[-157.81452789902687,21.30329533016608]],[[-157.81454801559448,21.30386508614299],[-157.81476393342018,21.303856339905664],[-157.81475454568863,21.303661423624263],[-157.81453862786293,21.303670169873214],[-157.81454801559448,21.30386508614299]],[[-157.81432807445526,21.3033028269696],[-157.81444743275642,21.303300328035135],[-157.8144447505474,21.303176630726142],[-157.81432539224625,21.303179129662695],[-157.81432807445526,21.3033028269696]],[[-157.81486049294472,21.30356646431659],[-157.81506836414337,21.303557718061484],[-157.81505897641182,21.303357803517002],[-157.81485110521317,21.303366549784016],[-157.81486049294472,21.30356646431659]],[[-157.8148564696312,21.303762630187265],[-157.81497985124588,21.303758881797293],[-157.81497582793236,21.303638933267464],[-157.81485244631767,21.303642681660506],[-157.8148564696312,21.303762630187265]],[[-157.81433075666428,21.303790118377535],[-157.814462184906,21.30378387106201],[-157.81445547938347,21.30365892469591],[-157.81432405114174,21.303665172016736],[-157.81433075666428,21.303790118377535]]]},"type":"Feature","properties":{"extrude":"true","height":20,"min_height":0,"type":"university","underground":"false"},"id":7,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "business_administration_shidler": {"geometry":{"type":"Polygon","coordinates":[[[-157.82038986682892,21.301461100744348],[-157.8203885257244,21.301429863668986],[-157.82008945941925,21.301443607982975],[-157.81976625323296,21.301116243064413],[-157.81990841031075,21.300990044943035],[-157.81990304589272,21.30086009824936],[-157.81986817717552,21.30086134773734],[-157.81986683607101,21.300812617698],[-157.8199017047882,21.300811368209594],[-157.81989768147469,21.30071515757082],[-157.82005459070206,21.300710159613857],[-157.82005861401558,21.300808869232768],[-157.82045155763626,21.300797623836488],[-157.82044753432274,21.300707660635297],[-157.82070368528366,21.300698914210017],[-157.82070770859718,21.300788877416565],[-157.8208538889885,21.30078512895072],[-157.82086193561554,21.30101378519197],[-157.82060846686363,21.301023781085107],[-157.82049849629402,21.301166222488447],[-157.82050117850304,21.30122869674463],[-157.82053738832474,21.30122869674463],[-157.82054141163826,21.301334902919137],[-157.8205293416977,21.301334902919137],[-157.82053336501122,21.301426115219513],[-157.82044753432274,21.301428614185838],[-157.82044887542725,21.30145985126147],[-157.82038986682892,21.301461100744348]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "crawford_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.819412201643,21.30043277273485],[-157.81940683722496,21.300197868121572],[-157.81975954771042,21.300190371159644],[-157.81976491212845,21.30041652934284],[-157.81967908143997,21.3004177788346],[-157.81967774033546,21.30033156387836],[-157.819504737854,21.30033531235577],[-157.8195060789585,21.300430273751587],[-157.819412201643,21.30043277273485]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "dean_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.8193961083889,21.299619351435666],[-157.8193947672844,21.299444421535753],[-157.81948998570442,21.299443172035737],[-157.81949132680893,21.299455667035588],[-157.8196468949318,21.29945316803571],[-157.8196468949318,21.299438174035487],[-157.8197367489338,21.2994369245354],[-157.8197394311428,21.299613103942818],[-157.8196482360363,21.299614353441413],[-157.8196482360363,21.29960310795373],[-157.81949132680893,21.29960560695106],[-157.81949132680893,21.299618101937128],[-157.8193961083889,21.299619351435666]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "duke_kahanamoku_pool": {"geometry":{"type":"Polygon","coordinates":[[[-157.81805366277695,21.294532554846242],[-157.81807646155357,21.294345123458825],[-157.81788870692253,21.294132700930845],[-157.81791552901268,21.293877793492086],[-157.81816095113754,21.29367911532887],[-157.81810194253922,21.2936128892148],[-157.81809657812119,21.29359289641978],[-157.81811267137527,21.29357915137163],[-157.817884683609,21.293344235804554],[-157.81786993145943,21.293355481771115],[-157.81752794981003,21.29299561041468],[-157.81767949461937,21.29287190443243],[-157.81794637441635,21.293134310937646],[-157.81791016459465,21.293158052455468],[-157.81803488731384,21.293284257301735],[-157.81800404191017,21.29331299700405],[-157.81817570328712,21.29348793420135],[-157.81821325421333,21.293495431505136],[-157.8182253241539,21.293364228633394],[-157.81826958060265,21.293366727736796],[-157.8182427585125,21.29365412434595],[-157.81836077570915,21.29366287119045],[-157.81832858920097,21.294011494997918],[-157.81823471188545,21.294003997720452],[-157.81821459531784,21.294253906763828],[-157.81825214624405,21.294318883045506],[-157.81823068857193,21.294532554846242],[-157.81805366277695,21.294532554846242]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"building","underground":"false"},"id":5,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "everly_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.82210111618042,21.2989458701787],[-157.82149761915207,21.298932125631126],[-157.8215016424656,21.29876219293662],[-157.82210513949394,21.298775937500096],[-157.82210111618042,21.2989458701787]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "george_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.82003715634346,21.30070641114601],[-157.82003447413445,21.300591458085577],[-157.82030805945396,21.300586460124393],[-157.82030269503593,21.300332813370844],[-157.82014176249504,21.30033531235577],[-157.82014444470406,21.30046900798753],[-157.82003581523895,21.300471506970126],[-157.82002910971642,21.300167880271587],[-157.82041132450104,21.300160383308125],[-157.8204220533371,21.300700163699375],[-157.82003715634346,21.30070641114601]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "gilmore_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81649932265282,21.30175722788887],[-157.81649261713028,21.301578552088273],[-157.8165704011917,21.301573554160655],[-157.8165663778782,21.301504832638685],[-157.81670585274696,21.301507331603688],[-157.8168211877346,21.301504832638685],[-157.81691774725914,21.30149608626087],[-157.81692042946815,21.30154481607356],[-157.8170384466648,21.301541067627],[-157.81704515218735,21.301691005414682],[-157.81699553132057,21.301696003338307],[-157.81699553132057,21.301740984643246],[-157.81649932265282,21.30175722788887]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "hamilton_library": {"geometry":{"type":"Polygon","coordinates":[[[-157.8159400820732,21.301231195714323],[-157.8159213066101,21.30075264224277],[-157.81583681702614,21.30075014326495],[-157.8158301115036,21.300401535440912],[-157.81590789556503,21.300397786965192],[-157.815902531147,21.30024909735117],[-157.816441655159,21.300236602418778],[-157.8164617717266,21.30076888559765],[-157.8165167570114,21.3008213641165],[-157.81693652272224,21.300807619744333],[-157.8169485926628,21.30119870910498],[-157.8159400820732,21.301231195714323]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "hawaii_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.8189253807068,21.300284083156242],[-157.81892403960228,21.300222857991898],[-157.8188891708851,21.300222857991898],[-157.81888648867607,21.300082914663363],[-157.81891733407974,21.300082914663363],[-157.8189119696617,21.299815522575713],[-157.81888648867607,21.299815522575713],[-157.81888380646706,21.299666832372566],[-157.81910508871078,21.299663083878116],[-157.8191077709198,21.299815522575713],[-157.81908228993416,21.299816772072575],[-157.8190876543522,21.300070419716818],[-157.81911849975586,21.300069170222116],[-157.81912118196487,21.30021910951163],[-157.81909435987473,21.300220359005067],[-157.81909570097923,21.300281584170435],[-157.8189253807068,21.300284083156242]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "hawaii_institue_of_geophysics_noaa": {"geometry":{"type":"Polygon","coordinates":[[[-157.816264629364,21.298546028269215],[-157.81625255942345,21.29829487701359],[-157.8165154159069,21.29828488093483],[-157.81650200486183,21.297988746793237],[-157.81627669930458,21.29799749337981],[-157.81626999378204,21.29783880522818],[-157.81670585274696,21.297821312035623],[-157.81673669815063,21.29852853516084],[-157.816264629364,21.298546028269215]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "health_physical_education": {"geometry":{"type":"Polygon","coordinates":[[[-157.81805366277695,21.294532554846242],[-157.81807646155357,21.294345123458825],[-157.81788870692253,21.294132700930845],[-157.81791552901268,21.293877793492086],[-157.81816095113754,21.29367911532887],[-157.81810194253922,21.2936128892148],[-157.81809657812119,21.29359289641978],[-157.81811267137527,21.29357915137163],[-157.817884683609,21.293344235804554],[-157.81786993145943,21.293355481771115],[-157.81752794981003,21.29299561041468],[-157.81767949461937,21.29287190443243],[-157.81794637441635,21.293134310937646],[-157.81791016459465,21.293158052455468],[-157.81803488731384,21.293284257301735],[-157.81800404191017,21.29331299700405],[-157.81817570328712,21.29348793420135],[-157.81821325421333,21.293495431505136],[-157.8182253241539,21.293364228633394],[-157.81826958060265,21.293366727736796],[-157.8182427585125,21.29365412434595],[-157.81836077570915,21.29366287119045],[-157.81832858920097,21.294011494997918],[-157.81823471188545,21.294003997720452],[-157.81821459531784,21.294253906763828],[-157.81825214624405,21.294318883045506],[-157.81823068857193,21.294532554846242],[-157.81805366277695,21.294532554846242]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"building","underground":"false"},"id":5,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]]}},"source":"composite","sourceLayer":"building","state":{}
    },
    "health_physical_education_klum_gym": {"geometry":{"type":"Polygon","coordinates":[[[-157.81913593411446,21.29573710819271],[-157.81868398189545,21.29529977150078],[-157.81893208622932,21.295078603592586],[-157.81938269734383,21.29551469140914],[-157.81913593411446,21.29573710819271]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"building","underground":"false"},"id":1,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]]}},"source":"composite","sourceLayer":"building","state":{}
    },
    "keller_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81546398997307,21.29987424891702],[-157.81545594334602,21.29966933136882],[-157.816082239151,21.299646840400996],[-157.81609028577805,21.29985300747714],[-157.81546398997307,21.29987424891702]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "kennedy_theatre": {"geometry":{"type":"Polygon","coordinates":[[[-157.81515687704086,21.299569371485518],[-157.81515419483185,21.29947066103402],[-157.81473845243454,21.299478158032656],[-157.814731746912,21.299130796693944],[-157.81513139605522,21.29912329967756],[-157.8151300549507,21.29904458098268],[-157.8153459727764,21.299039582968888],[-157.81535804271698,21.299565622988567],[-157.81515687704086,21.299569371485518]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "korean_studies": {"geometry":{"type":"MultiPolygon","coordinates":[[[[-157.81437769532204,21.30127492767707],[-157.814369648695,21.301172469915272],[-157.81445547938347,21.301167471973855],[-157.814462184906,21.30126992973915],[-157.81437769532204,21.30127492767707]]],[[[-157.81409472227097,21.30131616065863],[-157.8140839934349,21.30097755007364],[-157.81428784132004,21.30097255212557],[-157.8142985701561,21.301311162722072],[-157.81409472227097,21.30131616065863]]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "krauss_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.8179557621479,21.297256530700096],[-157.81740054488182,21.297249033588116],[-157.81740590929985,21.296907914588942],[-157.8175427019596,21.29690916411053],[-157.8175400197506,21.297109087427813],[-157.81782299280167,21.297114085507275],[-157.81782567501068,21.296934154540054],[-157.81795978546143,21.29693540406143],[-157.8179557621479,21.297256530700096]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "law_library": {"geometry":{"type":"Polygon","coordinates":[[[-157.8179182112217,21.2965380557319],[-157.81679973006248,21.29644309182116],[-157.81682521104813,21.296170694999915],[-157.81794369220734,21.296266908613703],[-157.8179182112217,21.2965380557319]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "law_school": {"geometry":{"type":"Polygon","coordinates":[[[-157.81920433044434,21.29658928623722],[-157.81856060028076,21.29656804432254],[-157.81856060028076,21.29623192185234],[-157.81923651695251,21.296256912397027],[-157.81920433044434,21.29658928623722]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "les_murakami_stadium": {"geometry":{"type":"Polygon","coordinates":[[[-157.81609028577805,21.29373784412205],[-157.81596288084984,21.293731596379217],[-157.81576439738274,21.293680364877915],[-157.815809994936,21.293536666669226],[-157.81581535935402,21.29349793060632],[-157.8159561753273,21.293522921615818],[-157.81610906124115,21.29352667026687],[-157.8162257373333,21.293496681055757],[-157.81634911894798,21.293431704410636],[-157.81643092632294,21.293330490733155],[-157.81646981835365,21.29324302206686],[-157.81646713614464,21.293148056027377],[-157.81643629074097,21.292968120205387],[-157.81659454107285,21.29294687776742],[-157.81660795211792,21.293018102400254],[-157.8166227042675,21.29316055156241],[-157.8166200220585,21.2932805086445],[-157.81659454107285,21.293384221459505],[-157.81655296683311,21.29347418914338],[-157.8164966404438,21.293547912621065],[-157.81642690300941,21.293616637863565],[-157.81632363796234,21.29368411352496],[-157.8162069618702,21.293726598184747],[-157.81609028577805,21.29373784412205]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"building","underground":"false"},"id":5,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "marine_science": {"geometry":{"type":"Polygon","coordinates":[[[-157.8154344856739,21.298082460193726],[-157.81541973352432,21.297725099439347],[-157.81589180231094,21.29770760623326],[-157.81590521335602,21.298064967030157],[-157.8154344856739,21.298082460193726]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "miller_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.8181166946888,21.299531886511744],[-157.8181166946888,21.299513144021276],[-157.81806841492653,21.299513144021276],[-157.8180630505085,21.299225758868076],[-157.8181153535843,21.299224509366198],[-157.8181153535843,21.29920201833029],[-157.81819447875023,21.299200768828214],[-157.81819447875023,21.29922325986429],[-157.81824678182602,21.29922201036237],[-157.81825080513954,21.299508146023413],[-157.81820252537727,21.29950939552289],[-157.81820252537727,21.299530637012438],[-157.8181166946888,21.299531886511744]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "moore_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81492486596107,21.301233694683972],[-157.81492084264755,21.30106001619204],[-157.81502947211266,21.301056267733117],[-157.81502544879913,21.300925071610564],[-157.81476259231567,21.300931319047606],[-157.81475722789764,21.30076263815367],[-157.81531110405922,21.30075014326495],[-157.81531512737274,21.30091757468574],[-157.8151796758175,21.300921323148202],[-157.815183699131,21.301058766705737],[-157.81545728445053,21.301052519274094],[-157.81546264886856,21.301219950350358],[-157.81492486596107,21.301233694683972]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "multipurpose_building": {"geometry":{"type":"Polygon","coordinates":[[[-157.82226741313934,21.297692612054973],[-157.8221145272255,21.297687613995194],[-157.82212659716606,21.29736024070978],[-157.8222794830799,21.297365238780685],[-157.82226741313934,21.297692612054973]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"school","underground":"false"},"id":11,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "music_complex": {"geometry":{"type":"Polygon","coordinates":[[[-157.82088473439217,21.296325636372984],[-157.82030403614044,21.29629689725968],[-157.82030001282692,21.29579083803941],[-157.82010152935982,21.295785839914956],[-157.82011225819588,21.295430972644994],[-157.82068088650703,21.295465959596996],[-157.82068625092506,21.295375993132154],[-157.82080426812172,21.29537099499359],[-157.8210188448429,21.29554592974175],[-157.82100677490234,21.295752102570518],[-157.82090082764626,21.295752102570518],[-157.82088473439217,21.296325636372984]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "pacific_ocean_science_and_technology": {"geometry":{"type":"Polygon","coordinates":[[[-157.81607821583748,21.297737594585286],[-157.81605944037437,21.29722279369321],[-157.81655296683311,21.29720654994641],[-157.81657174229622,21.297721350895372],[-157.81607821583748,21.297737594585286]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "physical_science": {"geometry":{"type":"Polygon","coordinates":[[[-157.81592532992363,21.299540633006487],[-157.815899848938,21.298918381082245],[-157.81615734100342,21.298909634550483],[-157.81618282198906,21.299531886511744],[-157.81592532992363,21.299540633006487]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "queen_liliuokalani_center_for_students": {"geometry":{"type":"Polygon","coordinates":[[[-157.8180979192257,21.30070891012457],[-157.81808853149414,21.300339060833082],[-157.81813949346542,21.30029158011338],[-157.818603515625,21.300284083156242],[-157.81864643096924,21.300332813370844],[-157.81864643096924,21.300697664720644],[-157.8180979192257,21.30070891012457]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "sakamaki_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81687885522842,21.29789003528012],[-157.8168547153473,21.297092843668437],[-157.81725704669952,21.297082847507923],[-157.81728118658066,21.29788003917382],[-157.81687885522842,21.29789003528012]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":10,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "saunders_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.8189294040203,21.300876341592357],[-157.81893208622932,21.30083136002274],[-157.8189830482006,21.300832609510977],[-157.8189817070961,21.300796374347954],[-157.81893074512482,21.300796374347954],[-157.81893208622932,21.30070641114601],[-157.818962931633,21.30070641114601],[-157.8189615905285,21.300536480503155],[-157.81913593411446,21.300356553725948],[-157.81931832432747,21.300536480503155],[-157.81931430101395,21.3008213641165],[-157.8193397819996,21.300826362069714],[-157.8193397819996,21.30086384671327],[-157.81925663352013,21.30086384671327],[-157.8192539513111,21.300826362069714],[-157.81902596354485,21.300826362069714],[-157.81902864575386,21.300876341592357],[-157.8189294040203,21.300876341592357]],[[-157.81920164823532,21.300696415231272],[-157.81920164823532,21.300575214711102],[-157.8190742433071,21.30057396522068],[-157.8190729022026,21.300695165741885],[-157.81920164823532,21.300696415231272]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":12,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "stan_sheriff_center": {"geometry":{"type":"Polygon","coordinates":[[[-157.81856060028076,21.294532554846242],[-157.81856060028076,21.29395651495416],[-157.81856194138527,21.29395401586079],[-157.81860753893852,21.293902784436995],[-157.81866118311882,21.29386029982811],[-157.81872019171715,21.29382406294613],[-157.8187845647335,21.293797822439814],[-157.81885296106339,21.293780328766317],[-157.81892269849777,21.293772831477042],[-157.81899377703667,21.29377408102529],[-157.81906217336655,21.293785326958968],[-157.81913325190544,21.29380781882371],[-157.8191976249218,21.293840307066745],[-157.81925663352013,21.293882791681398],[-157.81930893659592,21.29393152401839],[-157.81935185194016,21.293989003164327],[-157.81938403844833,21.294050230925492],[-157.81940549612045,21.29411645684253],[-157.8194162249565,21.29418518181926],[-157.819414883852,21.294253906763828],[-157.81940147280693,21.29432263167628],[-157.8193773329258,21.29438760792759],[-157.8193424642086,21.29444883552273],[-157.81929820775986,21.294503815382342],[-157.81926602125168,21.294532554846242],[-157.81856060028076,21.294532554846242]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"building","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "webster_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.81764462590218,21.30091007776052],[-157.81762450933456,21.300462760530806],[-157.81755477190018,21.300465259513516],[-157.81755208969116,21.300394038489372],[-157.81762182712555,21.30039153950544],[-157.81761914491653,21.300336561848226],[-157.8178471326828,21.300327815400863],[-157.81787127256393,21.30090133134729],[-157.81764462590218,21.30091007776052]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":8,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    },
    "wist_hall": {"geometry":{"type":"Polygon","coordinates":[[[-157.82206490635872,21.29876219293662],[-157.8218986093998,21.29875719491322],[-157.82190531492233,21.29858851152376],[-157.8215378522873,21.298577265957576],[-157.82154455780983,21.298381093164636],[-157.8220997750759,21.298397336781647],[-157.82209306955338,21.29858601250912],[-157.82207161188126,21.29858601250912],[-157.82206490635872,21.29876219293662]]]},"type":"Feature","properties":{"extrude":"true","height":3,"min_height":0,"type":"university","underground":"false"},"id":13,"layer":{"id":"3d-buildings","type":"fill-extrusion","source":"composite","source-layer":"building","minzoom":15,"filter":["==","extrude","true"],"paint":{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":0.6}},"source":"composite","sourceLayer":"building","state":{}
    }
}

var reloads = 0;

var bounds = [
    [-157.822126, 21.292134], // Southwest coordinates
    [-157.812251, 21.306181]  // Northeast coordinates
]; 
var map = new mapboxgl.Map({
    style: 'mapbox://styles/mapbox/light-v9',
    center: [-157.8199, 21.2987],
    zoom: 17,
    pitch: 45,
    bearing: -17.6,
    container: 'map',
    maxBounds: bounds
});

$('input[name="daterange"]').daterangepicker({}, function (start, end, label) {
    var url = 'https://t6snn1lxw3.execute-api.us-west-2.amazonaws.com/default/DataS3GET/' + start.format('YYYY-MM-DDThh:mm:ss') + '/' + end.format('YYYY-MM-DDThh:mm:ss');
    updateData(url);

    $($('.micro')[0]).text("");
    $($('.micro')[1]).text("");
    $($('.micro')[2]).text("");
    $($('.micro')[3]).text("");
    $($('.micro')[4]).text("");
    $($('.micro')[5]).text("");

    $("#building-list").empty();

    for (let b in buildings) {
        buildings[b].num_of_buildings = 0;
        buildings[b].sumOfKWh = 0;
        map.removeLayer(b + reloads);
    }
    reloads += 1;
});

var max = 0;
function updateData(url) {
    $.getJSON(url, function (result) {
        max = 0;
        for(let i = 0; i < result.length; i++) {
            for (let key in result[i]) {
                var buildingName = key.toLowerCase().split(' ').join('_');
                if (buildingName in buildings) {
                    if (result[i][key] != 10000) {
                        if ("sumOfKWh" in buildings[buildingName]) {
                            buildings[buildingName].num_of_buildings += 1;
                            buildings[buildingName].sumOfKWh += result[i][key];
                        } else {
                            buildings[buildingName].num_of_buildings = 1;
                            buildings[buildingName].sumOfKWh = result[i][key];
                        }
                        if (result[i][key] > max) {
                            max = result[i][key];
                        }
                    }
                }
            }
        }

        $($('.micro')[5]).text(max.toFixed());
        $($('.micro')[0]).text("0");
        $($('.micro')[1]).text((2 * (100 / 6) * .01 * max.toFixed()).toFixed());
        $($('.micro')[2]).text((3 * (100 / 6) * .01 * max.toFixed()).toFixed());
        $($('.micro')[3]).text((4 * (100 / 6) * .01 * max.toFixed()).toFixed());
        $($('.micro')[4]).text((5 * (100 / 6) * .01 * max.toFixed()).toFixed());
        dataFinished();
    });
}
var url = 'https://t6snn1lxw3.execute-api.us-west-2.amazonaws.com/default/DataS3GET/2017-01-01T12:00:00/2017-01-02T11:59:59';

updateData(url);

var labelLayerId;

function dataFinished() {
    for (let b in buildings) {
        var opacity = .5;
        if ("sumOfKWh" in buildings[b] && "num_of_buildings" in buildings[b]) {
            opacity = (buildings[b].sumOfKWh / buildings[b].num_of_buildings) / max;
            opacity *= .5;
        }

        map.addLayer({
            'id': b + reloads,
            'source': {
                'type': 'geojson',
                'data': {
                    'type': 'FeatureCollection',
                    'features': [buildings[b]]
                }
            },
            'filter': ['==', 'extrude', 'true'],
            'type': 'fill-extrusion',
            'minzoom': 15,
            'paint': {
                'fill-extrusion-color': '#FF0000',
                'fill-extrusion-opacity': opacity,

                // use an 'interpolate' expression to add a smooth transition effect to the
                // buildings as the user zooms in
                'fill-extrusion-height': [
                    "interpolate", ["linear"], ["zoom"],
                    15, 0,
                    15.05, ["get", "height"]
                ],
                'fill-extrusion-base': [
                    "interpolate", ["linear"], ["zoom"],
                    15, 0,
                    15.05, ["get", "min_height"]
                ]
            }
        }, labelLayerId);

        map.on('click', b + reloads, function(e) {
            // Popups on clicks
            var coordinates = e.features[0].geometry.coordinates.slice()[0];
            var description = e.features[0].properties.description;
            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
            }
            var lng = 0;
            var lat = 0;
            coordinates.forEach(function(e, i, a) {
                lng += e[0];
                lat += e[1];
            });
            lng = lng / coordinates.length;
            lat = lat / coordinates.length;

            function avgHourPower(b) {
                return (buildings[b].sumOfKWh / buildings[b].num_of_buildings).toFixed();
            }
            function totalPower(b) {
                return (buildings[b].sumOfKWh / buildings[b].num_of_buildings).toFixed();
            }

            new mapboxgl.Popup()
                .setLngLat([lng, lat])
                .setHTML(`
                    <div>
                    <center>
                        <h2><u>${b.split('_').join(' ').toLowerCase().split(' ').map((s) => s.charAt(0).toUpperCase() + s.substring(1)).join(' ')}</u></h2>
                    </center>
                    <h3>Average Hourly Power Consumption: ${avgHourPower(b)}kWh</h3>
                    <h3>Total Power Consumption: ${totalPower(b)}kWh</h3>
                    </div>
                    `)
                .addTo(map);
        });
    }
    // Update Right Sidebar
    var sortable = [];
    for (let b in buildings) {
        sortable.push([b, buildings[b].sumOfKWh / buildings[b].num_of_buildings, buildings[b].geometry.coordinates[0][0]]);
    }

    for (let i = 0; i < sortable.length; i++) {
        if (isNaN(sortable[i][1])) {
            sortable.splice(i, 1);
            i -= 1;
        }
    }

    sortable.sort(function(a, b) {
        return b[1] - a[1];
    })

    for (let i = 0; i < 10; i++) {
        var buildingListItem = $(`<div style="cursor: pointer" class="txt-li">
                <strong>
                ${sortable[i][0].split('_').join(' ').toLowerCase().split(' ').map((s) => s.charAt(0).toUpperCase() + s.substring(1)).join(' ')}
                </strong>
            </div>`);

        buildingListItem.click(function() {
            map.flyTo({
                center: [sortable[i][2][0], sortable[i][2][1]]
            });
        });
        $("#building-list").append(buildingListItem);
    }
}


// The 'building' layer in the mapbox-streets vector source contains building-height
// data from OpenStreetMap.
map.on('load', function() {
    // Insert the layer beneath any symbol layer.
    var layers = map.getStyle().layers;

    for (var i = 0; i < layers.length; i++) {
        if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
            labelLayerId = layers[i].id;
            break;
        }
    }


});

</script>


</body>
</html>
